<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <title>Processing</title>
</head>

<body>
    <div class="container">
        <div class="preview-area">
            <img id="preview-image" src="{{ url_for('static', filename='preview/temporary.png') }}"
                onerror="{{ this.src=url_for('static', filename='preview/first_preview.png') }}" alt="Preview">
        </div>
        <div class="controls-area">
            <form action="/processing" method="post" enctype="multipart/form-data">
                <input type="file" name="file" accept="image/*" onchange="previewFile()">
                <button type="submit">Upload</button>
            </form>
            <!-- Add processing buttons here -->
            <button onclick="processImage('blur')">Blur</button>
            <button onclick="processImage('grayscale')">Grayscale</button>
            <!-- Add more processing buttons as needed -->
            <button id="save-button">Save</button>
        </div>
    </div>
    <script>
        function previewFile() {
            var preview = document.getElementById('preview-image');
            var fileInput = document.querySelector('input[type=file]');
            var file = fileInput.files[0];
            var reader = new FileReader();

            reader.onloadend = function () {
                preview.src = reader.result;
            }

            if (file) {
                reader.readAsDataURL(file);
            } else {
                preview.src = "";
            }
        }

        function processImage(effect) {
            // Implement image processing logic here
            // Update the preview with the processed image
            alert('Image processing logic for ' + effect);
        }

        document.getElementById('save-button').addEventListener('click', function () {
            var processedName = prompt('Enter a name for the processed image:');
            if (processedName) {
                var form = document.createElement('form');
                form.action = '/save';
                form.method = 'post';

                var input = document.createElement('input');
                input.type = 'hidden';
                input.name = 'processed_name';
                input.value = processedName;

                form.appendChild(input);
                document.body.appendChild(form);
                form.submit();
            }
        });
    </script>
</body>

</html>